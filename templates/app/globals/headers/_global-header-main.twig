{% import "@Elements/menus/_macro-menus.twig" as menus %}
{% import "@Elements/_macro-icon.twig" as icons %}
{% import "@Elements/_macro-logos.twig" as logos %}

{# Transparent header when Section Header Complex is the first section; otherwise white #}
{% set is_header_transparent = flexible_content is defined and flexible_content|length > 0 and flexible_content[0].component_name == 'section_header_complex' %}

<header x-data="{ 
        mobileNavOpen: false, 
        scrolledFromTop: false,
        isHeaderTransparent: {{ is_header_transparent ? 'true' : 'false' }}
    }"
        id="site-header" 
        x-init="scrolledFromTop = window.pageYOffset >= 50"
        @scroll.window="scrolledFromTop = window.pageYOffset >= 50"
        :class="{
            'bg-white border-b border-gray-200': !isHeaderTransparent,
            'bg-transparent site-header--over-hero': isHeaderTransparent && !scrolledFromTop
        }"
        class="fixed inset-x-0 top-0 z-10 px-4 site-header lg:px-8 js-header transition-colors duration-300 [.admin-bar_&]:top-[32px]"
>
    <!-- Main Header Content -->
    <div id="header-content" class="lg:container flex justify-between mx-auto xl:max-w-(--breakpoint-2xl) site-header__left">
        <!-- Left Section -->
        <div
            :class="scrolledFromTop ? 'opacity-0' : 'opacity-100'"
            class="flex relative w-20 lg:w-32 xl:w-48 transition-opacity duration-300 ease-in-out">
            <!-- Logo -->
            <a href="{{ site.url }}" class="block group absolute top-0 inset-x-0 transition-transform duration-300 ">
                <span 
                    :class="isHeaderTransparent ? 'ring-transparent' : 'ring-gray-200 bg-white'"
                    class="inline-flex w-full ring-2 ">
                    {{ logos.render_main_logo() }}
                </span>
                <span class="sr-only">{{ site.title }}</span>
            </a>
            <!-- END Logo -->
        </div>
        

        {# center navigation â€” white text over hero, dark when solid or scrolled #}
        <nav id="headerNavigation" 
             class="site-header__center w-full lg:px-8 xl:px-16 transition-colors duration-300 hidden lg:block main-header__nav"
             :class="isHeaderTransparent ? 'text-white' : 'text-gray-900'">
            {{ menus.render_mega_menu(menu.header_nav.get_items, {
                level: 0,
                classes: 'w-full',
                link_classes: 'sm:text-base tracking-wide font-semibold py-3 px-0.5 hover:bg-transparent [&>span]:rounded-sm transition-colors duration-300',
                })
            }}
        </nav>

        {# right actions #}
        <div id="headerActions" class="flex items-center justify-between space-x-4 header-actions site-header__right">

            <nav id="headerActions" class="hidden site-header__ctas lg:flex">
                {{ menus.render_buttons_menu(menu.header_buttons.get_items, {
                    over_hero: is_header_transparent,
                    style: 'secondary',
                    type: 'solid',
                    rest_style: 'white',
                    rest_type: 'outline',
                }) }}
            </nav> 

            <!-- Open Mobile Navigation lg:hidden  -->
            <div class="header-actions__mobile-menu mobile-menu lg:hidden">
                <button x-on:click="mobileNavOpen = true" type="button" class="inline-flex items-center justify-center px-2 py-2 text-sm font-semibold leading-5 text-white  rounded-sm hover:border-gray-300 hover:text-gray-900 hover:shadow-xs focus:ring-3 focus:ring-gray-300 focus:ring-opacity-25 active:border-gray-200 active:shadow-none mobile-menu__toggle" aria-controls="tkMobileNav">
                    {{ icons.icon({
                        path: 'controls',
                        name: 'bars-3-bottom-right',
                        classes: 'w-6 h-6',
                    }) }}
                    <span class="sr-only">Menu</span>
                </button>
            </div>
            <!-- END Open Mobile Navigation -->
        </div>
        <!-- END Right Section -->
    </div>
    <!-- END Main Header Content -->

    {% embed '@Layouts/slideovers/_component-slideover.twig' with {
            name: 'site-header__mobile-nav',
            trigger: 'mobileNavOpen',
            slideTitle: 'Navigation',
        }
    %}
        {% block slideContent %}
            {% import "@Elements/menus/_macro-menus.twig" as menus %}
            <nav class="flex flex-col items-start justify-between flex-1 space-y-4">

                 {{ menus.render_accordion_menu(menu.header_nav.get_items, {
                    level: 0,
                    classes: 'grid grid-cols-4 gap-8 mt-16 xl:mt-0',
                    link_classes: 'text-base font-semibold leading-6 text-gray-300 hover:text-white',
                    child_classes: 'text-sm leading-6 text-gray-300 mt-4 space-y-2',
                    child_link_classes: 'hover:text-white',
                
                }) }}
    
            </nav>
        {% endblock %}
    {% endembed  %}
</header>